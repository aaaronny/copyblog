<script id="jquery" src="https://code.jquery.com/jquery-1.10.2.js"></script>

<div id='outScr'>
	<script>

    function estrai(){
        
        var orig = document.getElementsByClassName('google-src-text');
        
        for (i=0; i<orig.length; ++i)
            orig[i].innerHTML = '';
        
        var x = document.getElementById('main').innerHTML;
        var y = x.replace(/(<[^<]*[^ ]*google-src-text[^<]*[^>]*[>]{1})/gi,"");
        y = y.replace(/<h1\b[^>]*>/gi,"<h1>");
        y = y.replace(/<h2\b[^>]*>/gi,"<h2>");
        y = y.replace(/<span\b[^>]*>/gi,"");
        y = y.replace(/<\/span>/gi,"");
        alert('Conversione in corso...');
        document.write(y);    
    }
        
</script>
</div>

<div id="all"></div>
<div id="main" style="display: none"></div>

<script id="engine">

	var preurl = '/copia?url=';
    
    $.get(preurl + 'https://www.healthline.com/health-news', function( data ) {
        $('#all').html($(data).find('ol').html());
        var aas = document.getElementById('all').getElementsByTagName('a');
        for (var t=0; t<aas.length; ++t){
            aas[t].href = "javascript:lsa('" + aas[t].href + "')";
        }
    });
    
    function lsa(url){        
    var outputScr = $('#outScr').html();
    
    $.get(preurl + url, function( data ) {
        cont = '<div>' + data + '</div>';
        
        alert( "Articolo caricato..." );
        
        var tit = $(cont).find('h1').text();
        var h1 = '<h1>' + tit + '</h1>';
        var txt = $(cont).find('article').html();
        try {
            var urlImg = $(cont).find('article').find('img').attr('src');
            urlImg = urlImg.replace('//i0.wp.com/', 'http://');
            urlImg = urlImg.replace(/[?]{1}.*/, '');
            //urlImg = preurl + urlImg;
            alert(urlImg);
        } catch{
            alert('IMMAGINE NON PRESENTE!');
        }
        
        document.title = tit;
        
        var product = h1 + txt;
        
        product = product.replace(/<h2\b[^>]*>/gi,"<h2>");
        
        product = product.replace(/<a\b[^>]*>/gi,"");
        product = product.replace(/<\/a>/gi,"");
        
        product = product.replace(/(\([0-9 ,]*\))/g,"");
        
        product = product.replace(/<p\b[^>]*>/gi,"");
        product = product.replace(/<\/p>/gi,"");
        
        product = product.replace(/<div\b[^>]*>/gi,"");
        product = product.replace(/<\/div>/gi,"");
        
        product = product.replace(/<span\b[^>]*>/gi,"");
        product = product.replace(/<\/span>/gi,"");
        
        product = product.replace(/<ol\b[^>]*>/gi,"<ol>");
        product = product.replace(/<ul\b[^>]*>/gi,"<ul>");        
        
        $('#main').html(product);
        
        var fc = document.getElementsByTagName('figure');
        for (var i=0; i<fc.length; ++i){
            var element = fc[i];
            element.innerHTML = '';
            element.parentNode.removeChild(element);
        }
    
        fc = document.getElementsByClassName('css-zwi7lx');
        for (var i=0; i<fc.length; ++i){
            var element = fc[i];
            element.innerHTML = '';
            element.parentNode.removeChild(element);
        }
    
        fc = document.getElementsByClassName('css-0');
        for (var i=0; i<fc.length; ++i){
            var element = fc[i];
            element.innerHTML = '';
            element.parentNode.removeChild(element);
        }
        
        var button = '<div id="pulsante" onclick="estrai()" style="background-color: black; opacity:0.5; width:100%; height: 100%; position: absolute; top: 0px; left: 0px;"></div>"'
        
        var finalBlob = '<html><head><title>' + tit + '</title>' + outputScr + '</head><body>' + button + '<div id="main">' + $('#main').html() + '</div></body></html>';
        
        var blob = new Blob([finalBlob], {type:"text/html"});
        var testo = window.URL.createObjectURL(blob);
        var file = tit + '.html';
        
        var downloadLink = document.createElement("a");
        downloadLink.download = file;
        downloadLink.innerHTML = "Download File";
        downloadLink.href = testo;
        downloadLink.style.display = "none";
        document.body.appendChild(downloadLink);
 
        downloadLink.click();
        
        var imgdw = '<button style="height: 70px; width:140px; color: white; background: red; border: none; font-size: 14pt" onclick="location.reload();">TORNA INDIETRO</button><br/><br/><img src="' + urlImg + '" />';
        $('#all').html(imgdw);
        
        $('body').removeAttr('style');
                
        $('#engine').remove();
        $('#jquery').remove();
        
});
    
    }
        
</script>